{
  "meta": {
    "project": "CoffeeSquad",
    "date": "2025-12-30",
    "prepared_by": "Generated by Product Manager"
  },
  "product_overview": "CoffeeSquad is a comprehensive, multi-tenant SaaS platform designed for café businesses to manage their entire operations through a single integrated system, including ordering, inventory, menu design, client management, finance, staff roles, and administration.",
  "core_goals": [
    "Provide a unified platform to manage café operations from order taking to inventory control and finance.",
    "Ensure strict multi-tenant data isolation and role-based access control for secure operations.",
    "Enable real-time updates and offline support to improve user experience and operational efficiency.",
    "Incorporate AI tools for content generation and smart business insights.",
    "Offer scalable SaaS architecture suitable for individual cafés and small chain operators."
  ],
  "key_features": [
    "User authentication with email/password, password recovery, magic link, and onboarding workflows.",
    "Multi-tenant store management ensuring strict data segregation and role-based controls.",
    "Complete inventory system with CRUD, stock tracking, low stock alerts, and recipe associations.",
    "Visual menu design editor with live previews supporting variants and add-ons management.",
    "Order management via POS and real-time Kanban board including dine-in and takeaway with table and QR code support.",
    "Client management with loyalty points tracking and order history.",
    "Finance module with reporting, cash shift management, and payment integrations including MercadoPago.",
    "Staff and roles management with custom permissions per store and invitation workflows.",
    "Comprehensive audit logging of key user actions for security and compliance.",
    "AI integration using Google Gemini for product description generation and smart insights.",
    "Progressive Web App features with offline capabilities and sync.",
    "Public client ordering interface with menu, cart, checkout, and order tracking.",
    "SaaS multi-tenant admin panel for global store and user oversight."
  ],
  "user_flow_summary": [
    "User authenticates and completes onboarding including association to a specific store tenant.",
    "Store owners and staff manage inventory items, monitor stock levels, and link ingredients to recipes.",
    "Managers design and update menus visually, managing product variants and add-ons.",
    "Orders are created via POS interface or QR code scanning, linked to tables or clients, and tracked on a real-time order board.",
    "Clients place orders through a public menu interface and track order status in real time.",
    "Staff and managers review financial reports and handle payment processing during daily shifts.",
    "Admin users manage users, roles, and tenant configurations through the SaaS admin panel.",
    "Audit logs track all critical actions for accountability and compliance.",
    "AI assistant generates product descriptions and provides insights without blocking UI.",
    "PWA functionality ensures uninterrupted usage even offline with data syncing when reconnected."
  ],
  "validation_criteria": [
    "All users authenticate securely with multi-factor flows as needed and are assigned correct roles with no data leakage across tenants.",
    "Inventory and orders reflect real-time accurate stock levels and order statuses with consistent database persistence.",
    "Menu design changes persist correctly and preview updates dynamically without errors.",
    "Order creation workflow completes fully updating inventory, loyalty points, finance, and the order board in real time.",
    "Staff invitation flows send email invites and create user profiles with assigned permissions successfully.",
    "Audit log entries are generated for all significant system actions and accessible as needed.",
    "AI features respond with relevant content without blocking user interactions and handle API errors gracefully.",
    "PWA offline mode works seamlessly with sync on reconnect and service worker caches are effective.",
    "Finance reports display accurate totals and integrate correctly with payment gateways.",
    "Public client order system supports order placement, updates, and status tracking reliably."
  ],
  "code_summary": {
    "tech_stack": [
      "TypeScript",
      "React 19.2.3",
      "Vite 6.2.0",
      "TailwindCSS 4.1.18",
      "Supabase (PostgreSQL + Auth + Edge Functions)",
      "Framer Motion",
      "Recharts",
      "Google Generative AI (Gemini)",
      "React Router DOM 7.11.0",
      "Service Worker (PWA)"
    ],
    "features": [
      {
        "name": "Authentication",
        "description": "User login/logout with email/password, password recovery, magic links. Role-based access control with super admin hardcoded emails. AuthContext handles authentication state across the app.",
        "files": [
          "pages/Login.tsx",
          "contexts/AuthContext.tsx",
          "pages/auth/SetPassword.tsx",
          "pages/auth/AcceptInvite.tsx"
        ]
      },
      {
        "name": "Dashboard",
        "description": "Main dashboard with metrics overview including orders, inventory levels, and financial summaries. Shows real-time business insights.",
        "files": [
          "pages/Dashboard.tsx",
          "components/SmartInsights.tsx"
        ]
      },
      {
        "name": "Inventory Management",
        "description": "Complete CRUD for inventory items, stock tracking, alerts for low stock, recipe management with product-ingredient relationships. Largest feature module (176KB).",
        "files": [
          "pages/InventoryManagement.tsx",
          "pages/RecipeManagement.tsx",
          "components/StockAdjustmentModal.tsx",
          "components/StockTransferModal.tsx",
          "components/TransferStockModal.tsx",
          "components/InventoryAuditLog.tsx",
          "components/InventoryReports.tsx"
        ]
      },
      {
        "name": "Menu Design",
        "description": "Visual menu editor with theming, live preview, product variants, and addons management. Supports category organization and drag-drop ordering.",
        "files": [
          "pages/MenuDesign.tsx",
          "pages/MenuManagement.tsx",
          "pages/MenuPage.tsx",
          "components/MenuRenderer.tsx"
        ]
      },
      {
        "name": "Order Management",
        "description": "Kanban-style order board for tracking order status, order creation terminal (POS), order scanning via QR codes. Supports takeaway and dine-in orders.",
        "files": [
          "pages/OrderBoard.tsx",
          "pages/OrderCreation.tsx",
          "pages/OrderConfirmationPage.tsx",
          "components/ScanOrderModal.tsx",
          "components/OrderStatusDisplay.tsx",
          "hooks/useCreateOrder.ts",
          "hooks/useOrderStatus.ts"
        ]
      },
      {
        "name": "Client Management (CRM)",
        "description": "Customer relationship management with client profiles, loyalty points tracking, and client-specific order history.",
        "files": [
          "pages/Clients.tsx",
          "pages/Loyalty.tsx",
          "components/LoyaltyClientView.tsx",
          "contexts/ClientContext.tsx"
        ]
      },
      {
        "name": "Finance Module",
        "description": "Financial reporting with charts, cash shift management, payment processing integrations (MercadoPago). Invoice processing capabilities.",
        "files": [
          "pages/Finance.tsx",
          "pages/InvoiceProcessor.tsx",
          "components/PaymentSettings.tsx",
          "hooks/useCashShift.ts",
          "hooks/useMercadoPagoConnect.ts",
          "hooks/useCheckout.ts"
        ]
      },
      {
        "name": "Staff Management",
        "description": "Employee/staff management with custom roles and permissions per store. Role-based access control for different sections.",
        "files": [
          "pages/StaffManagement.tsx",
          "components/PermissionGuard.tsx",
          "components/RoleGuard.tsx"
        ]
      },
      {
        "name": "Store Settings",
        "description": "Store configuration including business details, staff invitations, payment settings, and multi-location management.",
        "files": [
          "pages/StoreSettings.tsx",
          "pages/Settings.tsx",
          "components/LocationManagerModal.tsx",
          "hooks/useStore.ts"
        ]
      },
      {
        "name": "SaaS Admin Panel",
        "description": "Multi-tenant administration for managing multiple stores/venues. Owner invitations, tenant overview, global user management.",
        "files": [
          "pages/SaaSAdmin.tsx",
          "components/admin/LiveActivityPanel.tsx"
        ]
      },
      {
        "name": "Table Management",
        "description": "Restaurant table layout management for dine-in service tracking.",
        "files": [
          "pages/TableManagement.tsx"
        ]
      },
      {
        "name": "QR Code System",
        "description": "QR code generation for tables, scanning functionality, and order linking via QR codes.",
        "files": [
          "pages/Scanner.tsx",
          "pages/QRResolver.tsx",
          "components/QRCodeCard.tsx",
          "lib/qrContext.ts",
          "lib/scanHandler.ts",
          "hooks/useOrderQR.ts"
        ]
      },
      {
        "name": "AI Chat Assistant",
        "description": "Integrated AI chat powered by Google Gemini for generating product descriptions and providing smart insights.",
        "files": [
          "components/AIChat.tsx",
          "components/AIStockInsight.tsx",
          "hooks/useAIContext.ts"
        ]
      },
      {
        "name": "Offline Support",
        "description": "PWA with Service Worker, IndexedDB for local data storage, offline indicator, and sync capabilities.",
        "files": [
          "sw.js",
          "lib/db.ts",
          "contexts/OfflineContext.tsx",
          "components/OfflineIndicator.tsx"
        ]
      },
      {
        "name": "Toast Notifications",
        "description": "Global toast notification system for user feedback and alerts.",
        "files": [
          "components/ToastSystem.tsx"
        ]
      },
      {
        "name": "Audit Log",
        "description": "Activity logging and audit trail for tracking user actions across the system.",
        "files": [
          "pages/AuditLog.tsx"
        ]
      },
      {
        "name": "Client Ordering (Public)",
        "description": "Public-facing pages for clients to view menu, place orders, and track order status.",
        "files": [
          "pages/client/ClientMenu.tsx",
          "pages/client/ClientCart.tsx",
          "pages/client/ClientOrderStatus.tsx",
          "pages/client/ClientCheckout.tsx",
          "components/client/CartDrawer.tsx",
          "components/client/OrderPickupTicket.tsx"
        ]
      },
      {
        "name": "Venue Control Panel",
        "description": "Real-time venue operations including live activity monitoring, kitchen display, and order fulfillment tracking.",
        "files": [
          "components/venue-control/VenueControlPanel.tsx",
          "components/venue-control/KitchenDisplaySystem.tsx",
          "components/venue-control/LiveActivityPanel.tsx"
        ]
      }
    ]
  }
}
