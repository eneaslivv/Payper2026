<!DOCTYPE html>
<html lang="es" class="dark">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CoffeeSquad - Professional Dashboard</title>
    <link rel="manifest" href="./manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:ital,wght@0,400;0,600;0,700;1,800&display=swap"
        rel="stylesheet">
    <!-- Icons: Using a standard Material Symbols Outlined link -->
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#3B4D35",
                        "accent": "#B4965C",
                        "neon": "#4ADE80",
                        "background-light": "#F8F9F7",
                        "background-dark": "#0D0F0D",
                        "surface-dark": "#141714",
                        "text-main": "#1A1D19",
                        "text-secondary": "#71766F",
                        "border-color": "#E2E4DF"
                    },
                    boxShadow: {
                        'soft': '0 4px 20px -2px rgba(0, 0, 0, 0.05)',
                        'neon-soft': '0 0 15px rgba(74, 222, 128, 0.2)',
                    },
                    fontFamily: {
                        "display": ["Plus Jakarta Sans", "sans-serif"]
                    }
                },
            },
        }
    </script>
    <style>
        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            -webkit-font-smoothing: antialiased;
            overscroll-behavior-y: contain;
            background-color: #0D0F0D;
        }

        /* Explicitly define icon font to prevent text rendering issues */
        .material-symbols-outlined {
            font-family: 'Material Symbols Outlined' !important;
            font-weight: normal;
            font-style: normal;
            font-size: 24px;
            line-height: 1;
            letter-spacing: normal;
            text-transform: none;
            display: inline-block;
            white-space: nowrap;
            word-wrap: normal;
            direction: ltr;
            -webkit-font-feature-settings: 'liga';
            -webkit-font-smoothing: antialiased;
        }

        .italic-black {
            font-style: italic;
            font-weight: 800;
            letter-spacing: -0.02em;
        }

        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }

        ::-webkit-scrollbar {
            width: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(0, 0, 0, 0.1);
            border-radius: 99px;
        }

        .dark ::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.05);
        }

        .subtle-border {
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        button,
        a {
            touch-action: manipulation;
            user-select: none;
        }

        .active-glow {
            box-shadow: 0 0 15px rgba(74, 222, 128, 0.15);
        }
    </style>
    <script type="importmap">
{
  "imports": {
    "react-dom/": "https://esm.sh/react-dom@^19.2.3/",
    "react-router-dom": "https://esm.sh/react-router-dom@^7.11.0",
    "recharts": "https://esm.sh/recharts@^3.6.0",
    "react/": "https://esm.sh/react@^19.2.3/",
    "react": "https://esm.sh/react@^19.2.3",
    "framer-motion": "https://esm.sh/framer-motion@^11.18.2",
    "@google/genai": "https://esm.sh/@google/genai@^1.34.0"
  }
}
</script>
    <link rel="stylesheet" href="/index.css">
</head>

<body className="font-sans antialiased selection:bg-neon selection:text-black overflow-hidden">
    <div id="root">
        <!-- Fallback content while JS loads -->
        <div id="loading-fallback"
            style="display:flex;height:100vh;align-items:center;justify-content:center;flex-direction:column;gap:20px;">
            <div
                style="width:48px;height:48px;border:4px solid rgba(74,222,128,0.2);border-top-color:#4ADE80;border-radius:50%;animation:spin 1s linear infinite;">
            </div>
            <p style="color:#4ADE80;font-size:12px;text-transform:uppercase;letter-spacing:0.2em;font-weight:700;">
                Cargando Sistema...</p>
        </div>
        <style>
            @keyframes spin {
                to {
                    transform: rotate(360deg)
                }
            }
        </style>
        <noscript>
            <div style="padding:40px;text-align:center;color:#f87171;">
                <h1>JavaScript Deshabilitado</h1>
                <p>Esta aplicaciÃ³n requiere JavaScript para funcionar.</p>
            </div>
        </noscript>
    </div>
    <script type="module" src="/src/main.tsx"></script>
    <script>
        // Initialize global state for animations
        window.globalState = {
            isNavigating: false
        };
    </script>
    <script>
        // DYNAMIC PWA MANIFEST GENERATION
        // This ensures that if a user installs the app from a Client Menu,
        // the PWA opens directly to that menu, not the Admin Login.
        (function () {
            try {
                const isClientMenu = window.location.hash.includes('#/m/');
                const hasSlug = window.location.hash.match(/#\/m\/([^\/]+)/);

                if (isClientMenu && hasSlug) {
                    console.log('ðŸ“± Client Mode Detected: Injecting Custom Manifest');
                    const slug = hasSlug[1];
                    const currentUrl = window.location.href; // Captures full URL including hash

                    const manifest = {
                        "name": "Carta Digital",
                        "short_name": "Carta",
                        "description": "Pide desde tu mesa",
                        "start_url": currentUrl,
                        "display": "standalone",
                        "background_color": "#0D0F0D",
                        "theme_color": "#000000",
                        "orientation": "portrait",
                        "icons": [
                            {
                                "src": "https://cdn-icons-png.flaticon.com/512/924/924514.png",
                                "sizes": "192x192",
                                "type": "image/png",
                                "purpose": "any maskable"
                            },
                            {
                                "src": "https://cdn-icons-png.flaticon.com/512/924/924514.png",
                                "sizes": "512x512",
                                "type": "image/png"
                            }
                        ]
                    };

                    const stringManifest = JSON.stringify(manifest);
                    const blob = new Blob([stringManifest], { type: 'application/json' });
                    const manifestURL = URL.createObjectURL(blob);

                    const link = document.querySelector('link[rel="manifest"]');
                    if (link) {
                        link.setAttribute('href', manifestURL);
                    } else {
                        const newLink = document.createElement('link');
                        newLink.rel = 'manifest';
                        newLink.href = manifestURL;
                        document.head.appendChild(newLink);
                    }
                }
            } catch (e) {
                console.error('Error injecting manifest:', e);
            }
        })();
    </script>
</body>

</html>